#################################################################
#Test area
#### ------ Fixa senare...
#Typ platta med Floor Plan inkl. kalender m t.ex. Fotboll Ingrid osv. osv.
#Sedan TTS med dessa vid entré på morgonen eller liknanade
#
#Fixa så att en typ boolean m en "Alarm panel" kan avgöra om huset är avlarmet eller inte
#

- id: extra_vvc_weekend
  alias: 'VVC on weekend earlier'
  condition:
    - condition: state
      entity_id: binary_sensor.workday
      state: 'off'
    - condition: state
      entity_id: group.household
      state: 'home'
  trigger:
    - platform: time
      at: '07:00'
  action:
    - service: homeassistant.turn_on
      data:
        entity_id: switch.vvc_135

- id: high_electric_price
  alias: 'Högt elpris'
  condition:
    - condition: time
      after: '08:00:00'
      before: '21:00:00'
  trigger:
    - platform: numeric_state
      entity_id: sensor.nibe_31372_10069
      above: 80
  action:
    - service: notify.ios_lars_iphone
      data:
        title: "Elpris!"
        message: "Spot-pris över 80 öre!"
        data:
          push:
            category: "alarm"
    - service: script.sonos_say
      data_template:
        sonos_entity: media_player.kokvardagsrum
        volume: 0.45
        delay: '00:00:15'
        message: 'Hej, tänk på att det just nu är högt elpris. Det ligger just nu på {{ states.sensor.nibe_31372_10069.state }} öre per kWh!'

- id: low_electric_price
  alias: 'Lågt elpris'
  condition:
    - condition: time
      after: '08:00:00'
      before: '21:00:00'
  trigger:
    - platform: numeric_state
      entity_id: sensor.nibe_31372_10069
      below: 20
  action:
    - service: notify.ios_lars_iphone
      data:
        title: "Elpris!"
        message: "Spot-pris under 20 öre!"
        data:
          push:
            category: "alarm"
    - service: script.sonos_say
      data_template:
        sonos_entity: media_player.kokvardagsrum
        volume: 0.45
        delay: '00:00:15'
        message: 'Hej, just nu är det lågt elpris, {{ states.sensor.nibe_31372_10069.state }} öre per kWh närmaste timen'

#################################
###### Other
#################################
# - id: theme_night
#   alias: 'Set dark theme for the night'
#   initial_state: 'on'
#   trigger:
#     - platform: time
#       at: '23:00'
#   action:
#     - service: frontend.set_theme
#       data:
#         name: night

# - id: theme_morning
#   alias: 'Set lighter theme for the morning'
#   initial_state: 'on'
#   trigger:
#     - platform: time
#       at: '08:00'
#   action:
#     - service: frontend.set_theme
#       data:
#         name: default

- id: esp_christmas_tree_water_level_low
  alias: 'Larm låg vattennivå granen'
  condition:
    - condition: time
      after: '08:00:00'
      before: '21:00:00'
    - condition: state
      entity_id: group.household
      state: 'home'
  trigger:
    - platform: state
      entity_id: binary_sensor.esp_christmas_tree_water_level_low
      to: 'off'
  action:
    - service: notify.ios_lars_iphone
      data:
        title: "Granen!"
        message: "Vattna granen, det är nästan slut på vatten!"
        data:
          push:
            category: "alarm"
    - service: script.sonos_say
      data_template:
        sonos_entity: media_player.kokvardagsrum
        volume: 0.45
        delay: '00:00:15'
        message: 'Hej, det är dags att vattna granen. Det börjar ta slut på vatten!'

- id: update_of_hass
  alias: 'Notification Update Hass Available'
  condition:
    - condition: time
      after: '08:00:00'
      before: '20:00:00'
  trigger:
    - platform: state
      entity_id: updater.updater
  action:
    - service: notify.ios_lars_iphone
      data:
        title: "Uppdatering!"
        message: "Ny version av Home Assistant tillgänglig!"
        data:
          push:
            badge: 10
            category: "alarm"
    - service: script.sonos_say
      data_template:
        sonos_entity: media_player.kokvardagsrum
        volume: 0.45
        delay: '00:00:15'
        message: 'Hej, det finns en ny uppdatering av Home Assistant'
